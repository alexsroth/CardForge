{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://cardforge.app/schemas/v1/card-template-layout.schema.json",
  "title": "Card Template Layout",
  "description": "V1 deterministic card template layout contract.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schemaVersion",
    "templateId",
    "name",
    "canvas",
    "elements"
  ],
  "properties": {
    "schemaVersion": {
      "type": "string",
      "const": "1.0.0"
    },
    "templateId": {
      "type": "string",
      "minLength": 1
    },
    "name": {
      "type": "string",
      "minLength": 1
    },
    "canvas": {
      "$ref": "#/$defs/Canvas"
    },
    "elements": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/LayoutElement"
      }
    }
  },
  "$defs": {
    "Canvas": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "width",
        "height"
      ],
      "properties": {
        "width": {
          "type": "integer",
          "minimum": 1
        },
        "height": {
          "type": "integer",
          "minimum": 1
        },
        "backgroundColor": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "Rect": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "x",
        "y",
        "width",
        "height"
      ],
      "properties": {
        "x": {
          "type": "integer"
        },
        "y": {
          "type": "integer"
        },
        "width": {
          "type": "integer",
          "minimum": 1
        },
        "height": {
          "type": "integer",
          "minimum": 1
        }
      }
    },
    "TextStyle": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "fontFamily": {
          "type": "string",
          "minLength": 1
        },
        "fontSize": {
          "type": "integer",
          "minimum": 1
        },
        "fontWeight": {
          "type": "string",
          "enum": [
            "normal",
            "medium",
            "semibold",
            "bold"
          ]
        },
        "color": {
          "type": "string",
          "minLength": 1
        },
        "align": {
          "type": "string",
          "enum": [
            "left",
            "center",
            "right"
          ]
        }
      }
    },
    "ShapeStyle": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "fillColor": {
          "type": "string",
          "minLength": 1
        },
        "strokeColor": {
          "type": "string",
          "minLength": 1
        },
        "strokeWidth": {
          "type": "integer",
          "minimum": 0
        },
        "cornerRadius": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "FieldBinding": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "type",
        "fieldKey"
      ],
      "properties": {
        "type": {
          "type": "string",
          "const": "field"
        },
        "fieldKey": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "StaticBinding": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "type",
        "value"
      ],
      "properties": {
        "type": {
          "type": "string",
          "const": "static"
        },
        "value": {
          "type": "string"
        }
      }
    },
    "TextElement": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "kind",
        "rect",
        "binding"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "const": "text"
        },
        "rect": {
          "$ref": "#/$defs/Rect"
        },
        "zIndex": {
          "type": "integer"
        },
        "binding": {
          "oneOf": [
            {
              "$ref": "#/$defs/FieldBinding"
            },
            {
              "$ref": "#/$defs/StaticBinding"
            }
          ]
        },
        "style": {
          "$ref": "#/$defs/TextStyle"
        }
      }
    },
    "ImageSlotElement": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "kind",
        "rect",
        "fieldKey"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "const": "imageSlot"
        },
        "rect": {
          "$ref": "#/$defs/Rect"
        },
        "zIndex": {
          "type": "integer"
        },
        "fieldKey": {
          "type": "string",
          "minLength": 1
        },
        "fit": {
          "type": "string",
          "enum": [
            "cover",
            "contain",
            "fill"
          ],
          "default": "cover"
        }
      }
    },
    "IconElement": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "kind",
        "rect",
        "binding"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "const": "icon"
        },
        "rect": {
          "$ref": "#/$defs/Rect"
        },
        "zIndex": {
          "type": "integer"
        },
        "binding": {
          "oneOf": [
            {
              "$ref": "#/$defs/FieldBinding"
            },
            {
              "$ref": "#/$defs/StaticBinding"
            }
          ]
        },
        "color": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "StatValueElement": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "kind",
        "rect",
        "fieldKey"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "const": "statValue"
        },
        "rect": {
          "$ref": "#/$defs/Rect"
        },
        "zIndex": {
          "type": "integer"
        },
        "fieldKey": {
          "type": "string",
          "minLength": 1
        },
        "label": {
          "type": "string"
        },
        "style": {
          "$ref": "#/$defs/TextStyle"
        }
      }
    },
    "ShapeContainerElement": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "kind",
        "rect",
        "shape"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "const": "shapeContainer"
        },
        "rect": {
          "$ref": "#/$defs/Rect"
        },
        "zIndex": {
          "type": "integer"
        },
        "shape": {
          "type": "string",
          "enum": [
            "rectangle",
            "circle"
          ]
        },
        "style": {
          "$ref": "#/$defs/ShapeStyle"
        }
      }
    },
    "LayoutElement": {
      "oneOf": [
        {
          "$ref": "#/$defs/TextElement"
        },
        {
          "$ref": "#/$defs/ImageSlotElement"
        },
        {
          "$ref": "#/$defs/IconElement"
        },
        {
          "$ref": "#/$defs/StatValueElement"
        },
        {
          "$ref": "#/$defs/ShapeContainerElement"
        }
      ]
    }
  }
}
